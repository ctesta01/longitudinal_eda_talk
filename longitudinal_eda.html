<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Exploratory Data Visualization for Time-Series and Longitudinal Data</title>
    <meta charset="utf-8" />
    <meta name="author" content="Christian Testa  ctesta@hsph.harvard.edu  @ctestaa" />
    <meta name="date" content="2025-10-24" />
    <script src="libs/header-attrs-2.29/header-attrs.js"></script>
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/default-fonts.css" rel="stylesheet" />
    <link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
    <script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
    <script src="libs/plotly-binding-4.11.0/plotly.js"></script>
    <script src="libs/typedarray-0.1/typedarray.min.js"></script>
    <script src="libs/jquery-3.5.1/jquery.min.js"></script>
    <link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
    <script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
    <link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
    <script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
  </head>
  <body>
    <textarea id="source">

name: xaringan-title
class: left, middle, inverse
background-color: '#BBB'
background-size: cover

&lt;style type="text/css"&gt;
.remark-code-line-highlighted { background-color: rgba(97, 172, 240, .5) !important; }

.huge .remark-code { /*Change made here*/
  font-size: 125% !important;
}


.tiny .remark-code { /*Change made here*/
  font-size: 50% !important;
}
&lt;/style&gt;


# Exploratory Data Visualization for Time-Series and Longitudinal Data

&lt;div style='font-size: 25px;'&gt;

Christian Testa &lt;br&gt;
&lt;a href='mailto:ctesta@hsph.harvard.edu'&gt;&lt;svg viewBox="0 0 512 512" style="height:1em;position:relative;display:inline-block;top:.1em;fill:#F92672;" xmlns="http://www.w3.org/2000/svg"&gt;  &lt;path d="M464 64H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V112c0-26.51-21.49-48-48-48zm0 48v40.805c-22.422 18.259-58.168 46.651-134.587 106.49-16.841 13.247-50.201 45.072-73.413 44.701-23.208.375-56.579-31.459-73.413-44.701C106.18 199.465 70.425 171.067 48 152.805V112h416zM48 400V214.398c22.914 18.251 55.409 43.862 104.938 82.646 21.857 17.205 60.134 55.186 103.062 54.955 42.717.231 80.509-37.199 103.053-54.947 49.528-38.783 82.032-64.401 104.947-82.653V400H48z"&gt;&lt;/path&gt;&lt;/svg&gt; ctesta@hsph.harvard.edu&lt;/a&gt; &lt;br&gt;
&lt;a style='color: #55acee;' href='https://fediscience.org/@ctesta'&gt;&lt;svg viewBox="0 0 448 512" style="height:1em;position:relative;display:inline-block;top:.1em;fill:#55acee;" xmlns="http://www.w3.org/2000/svg"&gt;  &lt;path d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48 0 0 0-63.72 28.5-63.72 125.7 0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54 0 0 1-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"&gt;&lt;/path&gt;&lt;/svg&gt; @ctesta&lt;/a&gt; &lt;br&gt;
&lt;a style='color: #636e72;' href='https://github.com/ctesta01'&gt;&lt;svg viewBox="0 0 496 512" style="height:1em;position:relative;display:inline-block;top:.1em;fill:#636e72;" xmlns="http://www.w3.org/2000/svg"&gt;  &lt;path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"&gt;&lt;/path&gt;&lt;/svg&gt; ctesta01&lt;/a&gt; &lt;br&gt; &lt;br&gt;

October 24, 2025
&lt;/div&gt;

&lt;img src="images/osha_covid.png" alt="Research Figure Showing correlations in COVID and OSHA complaints"/&gt;
&lt;span style='font-family: Open Sans; font-size: 12px;'&gt;Hanage, W.P., Testa, C., Chen, J.T. et al. [COVID-19: US federal accountability for entry, spread, and inequities—lessons for the future.](https://link.springer.com/article/10.1007/s10654-020-00689-2) Eur J Epidemiol 35, 995–1006 (2020). https://doi.org/10.1007/s10654-020-00689-2&lt;/span&gt;
  




---
# Motivations

&lt;span style='font-size: 25px;'&gt;
&gt; "The greatest value of a picture is when it forces us to notice what we never expected to see." –John Tukey

--

&gt; "Visualization is often used for evil - twisting insignificant data changes
and making them look meaningful. Don't do that crap if you want to be my friend.
Present results clearly and honestly. If something isn't working - those
reviewing results need to know." —John Tukey
&lt;/span&gt;

--

&lt;img src='images/EleanorLutz.png' height='400px'&gt;

---
# Aims

- Learn how to use data manipulation tools such as `dplyr` and `tidyr`
- Learn how to use `ggplot2`, a powerful, flexible framework for visualizing data in R
- Learn where to find more resources
  
&lt;img src='images/R-for-Data-Science.jpg'/&gt;

---
# Before we get started

There are some packages you'll want to make sure you have installed.


``` r
install.packages("tidyverse")
```



``` r
library(tidyverse, quietly = F, warn.conflicts = T)
```

```
## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
## ✔ dplyr     1.1.4     ✔ readr     2.1.5
## ✔ forcats   1.0.0     ✔ stringr   1.5.1
## ✔ ggplot2   4.0.0     ✔ tibble    3.3.0
## ✔ lubridate 1.9.4     ✔ tidyr     1.3.1
## ✔ purrr     1.1.0     
## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()
## ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors
```

---
# Example Data Set


``` r
df &lt;- readr::read_csv("example_data/example_dataset_1.csv")
```

```
## Rows: 400 Columns: 6
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: ","
## chr (2): strata, gender
## dbl (4): X2005, X2010, X2015, X2020
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
```

--

Why use `readr::read_csv`?
- Reports on the assumed column types, with options to override
- Loads faster
- Loads into a tibble, which are faster, better data.frames.
  
---
# Check out the data


``` r
knitr::kable(head(df,4))
```

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; strata &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; gender &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; X2005 &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; X2010 &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; X2015 &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; X2020 &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; A &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; M &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10.509583 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 15.796463 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14.918578 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 25.42652 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; A &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; M &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 19.413696 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 25.082179 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 25.200332 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 30.43139 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; A &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; M &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 12.475157 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 19.262194 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 19.930757 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 20.63809 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; A &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; F &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.284895 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5.251643 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 8.746856 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10.24585 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

Note that: 
- Data is in a wide format
- Column names need cleaning
- We have groups of participants

---
# Examine the categorical variables

Let's check what those groups are:


``` r
unique(df$strata)
```

```
## [1] "A" "B" "C" "D"
```

--

``` r
table(df$gender) 
```

```
## 
##   F   M 
## 210 190
```

---
# Summarize quantitative variables
--

``` r
df |&gt; select(-c(strata, gender)) |&gt;
  summary()
```

```
##      X2005            X2010            X2015            X2020       
##  Min.   : 0.000   Min.   : 0.000   Min.   : 0.000   Min.   : 0.000  
##  1st Qu.: 5.217   1st Qu.: 6.765   1st Qu.: 6.135   1st Qu.: 7.621  
##  Median : 9.292   Median :10.592   Median :10.280   Median :12.065  
##  Mean   : 9.537   Mean   :11.260   Mean   :10.677   Mean   :12.678  
##  3rd Qu.:12.851   3rd Qu.:15.073   3rd Qu.:14.331   3rd Qu.:17.638  
##  Max.   :34.977   Max.   :34.707   Max.   :33.236   Max.   :39.052
```
--
... Let's break this one down.

---

&lt;img src="images/pipe2.jpg" align='right' width='20%'
  style='padding: 50px;'&gt;&lt;br&gt;

# Intro to `|&gt;` and dplyr


``` r
df |&gt; select(-c(strata, gender)) |&gt;
  summary()
```

--

`|&gt;`, the pipe operator, is built into R since version 4.1.0 (released May 2021).

--
`x |&gt; f()` is equivalent to `f(x)` &lt;br&gt;
`x |&gt; f(y)` is equivalent to `f(x,y)` 


--
`df |&gt; select(-c(strata, gender))` is equivalent to &lt;br&gt;`select(df, -c(strata, gender))`


--
Read `x |&gt; f(y)` as "`x` gets passed to `f` with additional 
argument `y`."


--
Using pipes helps to:
  1. chain several commands together,
  2. without creating unnecessarily nested one-liners, e.g. &lt;br&gt;
  `summary(select(df, -strata))`

---
# What's the deal with select?


``` r
df |&gt; select(-c(strata, gender)) |&gt;
  summary()
```

`select` is the command for subsetting the columns of a data.frame or 
tibble.


--
Notice that `strata` and `gender` are not in quotes. This is because `dplyr` and
many of the functions in the tidyverse use tidy-evaluation, which allows users
to reference column names of data.frames and tibbles as if they are variables
within tidyverse functions.


--
The minus sign is saying that we want to remove strata and gender, or
equivalently to select all of the columns except for strata and gender.



```
##      X2005            X2010            X2015            X2020       
##  Min.   : 0.000   Min.   : 0.000   Min.   : 0.000   Min.   : 0.000  
##  1st Qu.: 5.217   1st Qu.: 6.765   1st Qu.: 6.135   1st Qu.: 7.621  
##  Median : 9.292   Median :10.592   Median :10.280   Median :12.065  
##  Mean   : 9.537   Mean   :11.260   Mean   :10.677   Mean   :12.678  
##  3rd Qu.:12.851   3rd Qu.:15.073   3rd Qu.:14.331   3rd Qu.:17.638  
##  Max.   :34.977   Max.   :34.707   Max.   :33.236   Max.   :39.052
```

---
# Let's add participant ID numbers


``` r
df &lt;- df |&gt;
  mutate(id = row_number()) |&gt;
  select(id, everything())

knitr::kable(head(df,3))
```

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; id &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; strata &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; gender &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; X2005 &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; X2010 &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; X2015 &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; X2020 &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; A &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; M &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10.50958 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 15.79646 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14.91858 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 25.42652 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; A &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; M &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 19.41370 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 25.08218 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 25.20033 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 30.43139 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; A &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; M &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 12.47516 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 19.26219 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 19.93076 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 20.63809 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

--

`everything()` is part of the `tidyselect` package and system which 
helps with the programmatic selection of columns and offers other 
helpful functions like `starts_with` or `contains`.

---
# Referring to the left-hand-side

Some functions were written before the `tidyverse` became ubiquitous, 
and don't follow the convention that `data` should be the first argument. 

One example is the `lm` function. 

In situations like that, you can still pipe data into those functions, but
you need to use `_` to refer to the left-hand-side like this:


``` r
df |&gt; filter(strata == 'A') |&gt; 
  lm(formula = X2005 ~ gender, data = _) |&gt; 
  coef()
```

```
## (Intercept)     genderM 
##    5.327393    6.822105
```



---
# A note about `|&gt;` vs `%&gt;%`

&lt;small&gt;
`|&gt;` is a pipe now built into base R starting from version 4.1.0. 

Basically the main differences is that `%&gt;%` uses 
the `.` notation to refer to the left-hand-side of the pipe, 
while `|&gt;` uses `_` instead. There are some subtle differences
in what you can do with the left-hand-side (like `%&gt;%` allows you to use `.`
inside nested function calls
while `|&gt;` does not).

In many regards, the two pipes are similar, and you will start to 
see more and more code using `|&gt;` because it is new and faster than `%&gt;%`. 

Also, debugging is a bit easier with `|&gt;`.
&lt;/small&gt;

.pull-left[
&lt;a href="https://www.tidyverse.org/blog/2023/04/base-vs-magrittr-pipe/"&gt;&lt;img src="images/pipe_article.png" width='300px' /&gt; &lt;/a&gt;
]

.pull-right[
Read more here: &lt;https://www.tidyverse.org/blog/2023/04/base-vs-magrittr-pipe/&gt;
]


---

# Let's convert to a tidy format


``` r
df &lt;- df |&gt; tidyr::pivot_longer(
  cols = starts_with('X'),
  names_to = 'year',
  values_to = 'rate')

knitr::kable(head(df, 4))
```

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; id &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; strata &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; gender &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; year &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; rate &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; A &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; M &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; X2005 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10.50958 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; A &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; M &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; X2010 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 15.79646 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; A &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; M &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; X2015 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14.91858 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; A &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; M &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; X2020 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 25.42652 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
# Get rid of "X"


``` r
df &lt;- df |&gt;
  mutate(year = stringr::str_remove(year, "X"))

knitr::kable(head(df, 4))
```

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; id &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; strata &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; gender &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; year &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; rate &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; A &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; M &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2005 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10.50958 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; A &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; M &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2010 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 15.79646 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; A &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; M &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2015 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14.91858 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; A &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; M &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2020 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 25.42652 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
# Now we can do some plotting 

.pull-left[

``` r
ggplot(data = df,  
 aes(x = year, y = rate)) + 
   geom_point()
```

]

.pull-right[
&lt;img src="longitudinal_eda_files/figure-html/unnamed-chunk-18-1.png" width="100%" /&gt;
]

---
# Now let's try geom_line

.pull-left[

``` r
ggplot(data = df,  
 aes(x = year, y = rate,
*    group = id)) +
   geom_line()
```

]

.pull-right[
&lt;img src="longitudinal_eda_files/figure-html/unnamed-chunk-19-1.png" width="100%" /&gt;
]

---
# Adding color

.pull-left[

``` r
ggplot(data = df,  
 aes(x = year, y = rate,
     group = id,
*    color = strata)) +
*  geom_line(alpha=0.5)
```

]

.pull-right[
&lt;img src="longitudinal_eda_files/figure-html/unnamed-chunk-20-1.png" width="100%" /&gt;
]

---
# Facet Wrapping

.tiny[

``` r
ggplot(data = df,  aes(x = year, y = rate, group = id, color = strata)) +
  geom_line(alpha=0.5) + 
* facet_wrap(~strata)
```
]

&lt;img src="longitudinal_eda_files/figure-html/unnamed-chunk-21-1.png" width="576" height="100%" style="display: block; margin: auto;" /&gt;

---
# Facet Grid

.tiny[

``` r
ggplot(data = df,  aes(x = year, y = rate, group = id, color = strata)) +
  geom_line(alpha=0.5) + 
* facet_grid(gender~strata) +
  ggtitle("Different strata had different trajectories")
```
]

&lt;img src="longitudinal_eda_files/figure-html/unnamed-chunk-22-1.png" width="576" height="100%" style="display: block; margin: auto;" /&gt;


---
# Using Stat Summaries

.tiny[

``` r
ggplot(data = df,  aes(x = year, y = rate, group = id, color = gender)) +
  geom_line(alpha=0.5) + 
  facet_wrap(~strata) + 
  stat_summary(aes(group = interaction(strata, gender)), fun = mean, geom='line', color = 'black') + 
  stat_summary(aes(group = interaction(strata, gender), shape=gender), fun = mean, geom='point', size=2, color = 'black') + 
  labs(shape = 'Gender and Strata\nLevel Average', color = 'Gender') +
  ggtitle("Men have higher rates than women")
```
]

&lt;img src="longitudinal_eda_files/figure-html/unnamed-chunk-23-1.png" width="576" height="100%" style="display: block; margin: auto;" /&gt;

---
# Another way using boxplots

.tiny[

``` r
ggplot(data = df,  aes(x = year, y = rate, color = gender)) +
  geom_boxplot(alpha=0.5) + 
  stat_summary(aes(group = interaction(strata, gender), shape=''), position = position_dodge(width=0.75), 
               fun = mean, geom='point', color = 'grey10', alpha=0.8) +
  facet_wrap(~strata) + 
  labs(color = "Gender", shape = "Gender + Strata\nLevel Average") + 
  ggtitle("Boxplots allow us to see the interquartile range clearly")
```
]


&lt;img src="longitudinal_eda_files/figure-html/unnamed-chunk-24-1.png" width="576" height="100%" style="display: block; margin: auto;" /&gt;

---
# Using `geom_ribbon`

.tiny[

``` r
df |&gt; group_by(strata, gender, year) |&gt;
  summarize(
    percentile_97.5 = quantile(rate, 0.975),
    percentile_2.5 = quantile(rate, 0.025),
    mean = mean(rate),
    .groups = 'keep') |&gt;
  
  ggplot(aes(x = year, y = mean, ymax = percentile_97.5, 
       ymin = percentile_2.5, group = gender, fill = gender, color = gender)) +
    geom_ribbon(alpha=0.5, linewidth = 0) +
    geom_line(aes(linetype='')) +
    facet_wrap(~strata) + 
    scale_color_manual(values = c('M' = '#2980b9', 'F' = '#c0392b')) + 
    labs(linetype = 'Gender+Strata\nLevel Average', fill = 'Gender', color = 'Gender', y = 'Rate') + 
    ggtitle(paste0("The difference between men and women was consistent over time"))
```
]

&lt;img src="longitudinal_eda_files/figure-html/unnamed-chunk-25-1.png" width="432" height="100%" style="display: block; margin: auto;" /&gt;

---
# Using plotly for interactive graphics

.tiny[

``` r
suppressMessages(library(plotly))
ggplotly() |&gt; layout(width = 8, height = 3.5)
```

<div class="plotly html-widget html-fill-item" id="htmlwidget-f63e9d504c3e4bf09fb8" style="width:504px;height:504px;"></div>
<script type="application/json" data-for="htmlwidget-f63e9d504c3e4bf09fb8">{"x":{"data":[{"x":[1,2,3,4,4,3,2,1,1],"y":[0.15944384779508064,3.0387830915421765,6.3389244118795549,8.385279481257653,30.694048988616057,21.94356444316869,22.443381232513801,13.721880058389864,0.15944384779508064],"text":["year: 2005<br />mean:  5.327393<br />percentile_97.5: 13.72188<br />percentile_2.5:  0.15944385<br />gender: F<br />gender: F<br />gender: F","year: 2010<br />mean:  8.103492<br />percentile_97.5: 22.44338<br />percentile_2.5:  3.03878309<br />gender: F<br />gender: F<br />gender: F","year: 2015<br />mean: 11.726415<br />percentile_97.5: 21.94356<br />percentile_2.5:  6.33892441<br />gender: F<br />gender: F<br />gender: F","year: 2020<br />mean: 14.544723<br />percentile_97.5: 30.69405<br />percentile_2.5:  8.38527948<br />gender: F<br />gender: F<br />gender: F","year: 2020<br />mean: 14.544723<br />percentile_97.5: 30.69405<br />percentile_2.5:  8.38527948<br />gender: F<br />gender: F<br />gender: F","year: 2015<br />mean: 11.726415<br />percentile_97.5: 21.94356<br />percentile_2.5:  6.33892441<br />gender: F<br />gender: F<br />gender: F","year: 2010<br />mean:  8.103492<br />percentile_97.5: 22.44338<br />percentile_2.5:  3.03878309<br />gender: F<br />gender: F<br />gender: F","year: 2005<br />mean:  5.327393<br />percentile_97.5: 13.72188<br />percentile_2.5:  0.15944385<br />gender: F<br />gender: F<br />gender: F","year: 2005<br />mean:  5.327393<br />percentile_97.5: 13.72188<br />percentile_2.5:  0.15944385<br />gender: F<br />gender: F<br />gender: F"],"type":"scatter","mode":"lines","line":{"width":0,"color":"rgba(192,57,43,0.5)","dash":"solid"},"fill":"toself","fillcolor":"rgba(248,118,109,0.5)","hoveron":"points","name":"(F,1)","legendgroup":"(F,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,4,3,2,1,1],"y":[0.42472341838013028,0.35666507405595671,0,0.11828104578049344,18.130757566877488,17.248324050288311,19.440812875920024,18.520926916008811,0.42472341838013028],"text":["year: 2005<br />mean:  6.295177<br />percentile_97.5: 18.52093<br />percentile_2.5:  0.42472342<br />gender: F<br />gender: F<br />gender: F","year: 2010<br />mean:  6.346918<br />percentile_97.5: 19.44081<br />percentile_2.5:  0.35666507<br />gender: F<br />gender: F<br />gender: F","year: 2015<br />mean:  5.765133<br />percentile_97.5: 17.24832<br />percentile_2.5:  0.00000000<br />gender: F<br />gender: F<br />gender: F","year: 2020<br />mean:  6.167488<br />percentile_97.5: 18.13076<br />percentile_2.5:  0.11828105<br />gender: F<br />gender: F<br />gender: F","year: 2020<br />mean:  6.167488<br />percentile_97.5: 18.13076<br />percentile_2.5:  0.11828105<br />gender: F<br />gender: F<br />gender: F","year: 2015<br />mean:  5.765133<br />percentile_97.5: 17.24832<br />percentile_2.5:  0.00000000<br />gender: F<br />gender: F<br />gender: F","year: 2010<br />mean:  6.346918<br />percentile_97.5: 19.44081<br />percentile_2.5:  0.35666507<br />gender: F<br />gender: F<br />gender: F","year: 2005<br />mean:  6.295177<br />percentile_97.5: 18.52093<br />percentile_2.5:  0.42472342<br />gender: F<br />gender: F<br />gender: F","year: 2005<br />mean:  6.295177<br />percentile_97.5: 18.52093<br />percentile_2.5:  0.42472342<br />gender: F<br />gender: F<br />gender: F"],"type":"scatter","mode":"lines","line":{"width":0,"color":"rgba(192,57,43,0.5)","dash":"solid"},"fill":"toself","fillcolor":"rgba(248,118,109,0.5)","hoveron":"points","name":"(F,2)","legendgroup":"(F,2)","showlegend":true,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,4,3,2,1,1],"y":[0.053466760163304351,4.965760261352167,0.22485584758449795,6.7111902190070687,23.15981707547493,15.305294172688725,21.319821512747897,14.778189881749258,0.053466760163304351],"text":["year: 2005<br />mean:  6.026965<br />percentile_97.5: 14.77819<br />percentile_2.5:  0.05346676<br />gender: F<br />gender: F<br />gender: F","year: 2010<br />mean: 10.944576<br />percentile_97.5: 21.31982<br />percentile_2.5:  4.96576026<br />gender: F<br />gender: F<br />gender: F","year: 2015<br />mean:  7.009228<br />percentile_97.5: 15.30529<br />percentile_2.5:  0.22485585<br />gender: F<br />gender: F<br />gender: F","year: 2020<br />mean: 12.845895<br />percentile_97.5: 23.15982<br />percentile_2.5:  6.71119022<br />gender: F<br />gender: F<br />gender: F","year: 2020<br />mean: 12.845895<br />percentile_97.5: 23.15982<br />percentile_2.5:  6.71119022<br />gender: F<br />gender: F<br />gender: F","year: 2015<br />mean:  7.009228<br />percentile_97.5: 15.30529<br />percentile_2.5:  0.22485585<br />gender: F<br />gender: F<br />gender: F","year: 2010<br />mean: 10.944576<br />percentile_97.5: 21.31982<br />percentile_2.5:  4.96576026<br />gender: F<br />gender: F<br />gender: F","year: 2005<br />mean:  6.026965<br />percentile_97.5: 14.77819<br />percentile_2.5:  0.05346676<br />gender: F<br />gender: F<br />gender: F","year: 2005<br />mean:  6.026965<br />percentile_97.5: 14.77819<br />percentile_2.5:  0.05346676<br />gender: F<br />gender: F<br />gender: F"],"type":"scatter","mode":"lines","line":{"width":0,"color":"rgba(192,57,43,0.5)","dash":"solid"},"fill":"toself","fillcolor":"rgba(248,118,109,0.5)","hoveron":"points","name":"(F,3)","legendgroup":"(F,3)","showlegend":true,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[1,2,3,4,4,3,2,1,1],"y":[0.61719762387025068,0.012301143588057699,0,0,16.423673254148444,13.606579742071446,16.756253402141212,18.606696163001747,0.61719762387025068],"text":["year: 2005<br />mean:  7.711203<br />percentile_97.5: 18.60670<br />percentile_2.5:  0.61719762<br />gender: F<br />gender: F<br />gender: F","year: 2010<br />mean:  6.582965<br />percentile_97.5: 16.75625<br />percentile_2.5:  0.01230114<br />gender: F<br />gender: F<br />gender: F","year: 2015<br />mean:  5.108767<br />percentile_97.5: 13.60658<br />percentile_2.5:  0.00000000<br />gender: F<br />gender: F<br />gender: F","year: 2020<br />mean:  4.280819<br />percentile_97.5: 16.42367<br />percentile_2.5:  0.00000000<br />gender: F<br />gender: F<br />gender: F","year: 2020<br />mean:  4.280819<br />percentile_97.5: 16.42367<br />percentile_2.5:  0.00000000<br />gender: F<br />gender: F<br />gender: F","year: 2015<br />mean:  5.108767<br />percentile_97.5: 13.60658<br />percentile_2.5:  0.00000000<br />gender: F<br />gender: F<br />gender: F","year: 2010<br />mean:  6.582965<br />percentile_97.5: 16.75625<br />percentile_2.5:  0.01230114<br />gender: F<br />gender: F<br />gender: F","year: 2005<br />mean:  7.711203<br />percentile_97.5: 18.60670<br />percentile_2.5:  0.61719762<br />gender: F<br />gender: F<br />gender: F","year: 2005<br />mean:  7.711203<br />percentile_97.5: 18.60670<br />percentile_2.5:  0.61719762<br />gender: F<br />gender: F<br />gender: F"],"type":"scatter","mode":"lines","line":{"width":0,"color":"rgba(192,57,43,0.5)","dash":"solid"},"fill":"toself","fillcolor":"rgba(248,118,109,0.5)","hoveron":"points","name":"(F,4)","legendgroup":"(F,4)","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[1,2,3,4,4,3,2,1,1],"y":[7.1900421015077214,9.1686947902909033,13.325133821664501,14.046845780249361,30.335173709265501,26.487603391200388,24.66205762258954,19.28667855263485,7.1900421015077214],"text":["year: 2005<br />mean: 12.149498<br />percentile_97.5: 19.28668<br />percentile_2.5:  7.19004210<br />gender: M<br />gender: M<br />gender: M","year: 2010<br />mean: 16.253586<br />percentile_97.5: 24.66206<br />percentile_2.5:  9.16869479<br />gender: M<br />gender: M<br />gender: M","year: 2015<br />mean: 18.502823<br />percentile_97.5: 26.48760<br />percentile_2.5: 13.32513382<br />gender: M<br />gender: M<br />gender: M","year: 2020<br />mean: 21.329844<br />percentile_97.5: 30.33517<br />percentile_2.5: 14.04684578<br />gender: M<br />gender: M<br />gender: M","year: 2020<br />mean: 21.329844<br />percentile_97.5: 30.33517<br />percentile_2.5: 14.04684578<br />gender: M<br />gender: M<br />gender: M","year: 2015<br />mean: 18.502823<br />percentile_97.5: 26.48760<br />percentile_2.5: 13.32513382<br />gender: M<br />gender: M<br />gender: M","year: 2010<br />mean: 16.253586<br />percentile_97.5: 24.66206<br />percentile_2.5:  9.16869479<br />gender: M<br />gender: M<br />gender: M","year: 2005<br />mean: 12.149498<br />percentile_97.5: 19.28668<br />percentile_2.5:  7.19004210<br />gender: M<br />gender: M<br />gender: M","year: 2005<br />mean: 12.149498<br />percentile_97.5: 19.28668<br />percentile_2.5:  7.19004210<br />gender: M<br />gender: M<br />gender: M"],"type":"scatter","mode":"lines","line":{"width":0,"color":"rgba(41,128,185,0.5)","dash":"solid"},"fill":"toself","fillcolor":"rgba(0,191,196,0.5)","hoveron":"points","name":"(M,1)","legendgroup":"(M,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,4,3,2,1,1],"y":[6.1799531984469427,6.8321615459700276,8.014118023374154,7.9595542155274046,25.863923800295716,25.097873054944248,22.432236000146009,25.411280373218901,6.1799531984469427],"text":["year: 2005<br />mean: 13.501464<br />percentile_97.5: 25.41128<br />percentile_2.5:  6.17995320<br />gender: M<br />gender: M<br />gender: M","year: 2010<br />mean: 13.713107<br />percentile_97.5: 22.43224<br />percentile_2.5:  6.83216155<br />gender: M<br />gender: M<br />gender: M","year: 2015<br />mean: 13.811596<br />percentile_97.5: 25.09787<br />percentile_2.5:  8.01411802<br />gender: M<br />gender: M<br />gender: M","year: 2020<br />mean: 13.960148<br />percentile_97.5: 25.86392<br />percentile_2.5:  7.95955422<br />gender: M<br />gender: M<br />gender: M","year: 2020<br />mean: 13.960148<br />percentile_97.5: 25.86392<br />percentile_2.5:  7.95955422<br />gender: M<br />gender: M<br />gender: M","year: 2015<br />mean: 13.811596<br />percentile_97.5: 25.09787<br />percentile_2.5:  8.01411802<br />gender: M<br />gender: M<br />gender: M","year: 2010<br />mean: 13.713107<br />percentile_97.5: 22.43224<br />percentile_2.5:  6.83216155<br />gender: M<br />gender: M<br />gender: M","year: 2005<br />mean: 13.501464<br />percentile_97.5: 25.41128<br />percentile_2.5:  6.17995320<br />gender: M<br />gender: M<br />gender: M","year: 2005<br />mean: 13.501464<br />percentile_97.5: 25.41128<br />percentile_2.5:  6.17995320<br />gender: M<br />gender: M<br />gender: M"],"type":"scatter","mode":"lines","line":{"width":0,"color":"rgba(41,128,185,0.5)","dash":"solid"},"fill":"toself","fillcolor":"rgba(0,191,196,0.5)","hoveron":"points","name":"(M,2)","legendgroup":"(M,2)","showlegend":true,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,4,3,2,1,1],"y":[7.6191482482537651,11.17731523081488,7.0992393115585273,13.185690546664805,32.102698958986664,25.216910959717616,27.749722965597254,22.556376479097064,7.6191482482537651],"text":["year: 2005<br />mean: 13.125231<br />percentile_97.5: 22.55638<br />percentile_2.5:  7.61914825<br />gender: M<br />gender: M<br />gender: M","year: 2010<br />mean: 17.705141<br />percentile_97.5: 27.74972<br />percentile_2.5: 11.17731523<br />gender: M<br />gender: M<br />gender: M","year: 2015<br />mean: 14.341442<br />percentile_97.5: 25.21691<br />percentile_2.5:  7.09923931<br />gender: M<br />gender: M<br />gender: M","year: 2020<br />mean: 19.539365<br />percentile_97.5: 32.10270<br />percentile_2.5: 13.18569055<br />gender: M<br />gender: M<br />gender: M","year: 2020<br />mean: 19.539365<br />percentile_97.5: 32.10270<br />percentile_2.5: 13.18569055<br />gender: M<br />gender: M<br />gender: M","year: 2015<br />mean: 14.341442<br />percentile_97.5: 25.21691<br />percentile_2.5:  7.09923931<br />gender: M<br />gender: M<br />gender: M","year: 2010<br />mean: 17.705141<br />percentile_97.5: 27.74972<br />percentile_2.5: 11.17731523<br />gender: M<br />gender: M<br />gender: M","year: 2005<br />mean: 13.125231<br />percentile_97.5: 22.55638<br />percentile_2.5:  7.61914825<br />gender: M<br />gender: M<br />gender: M","year: 2005<br />mean: 13.125231<br />percentile_97.5: 22.55638<br />percentile_2.5:  7.61914825<br />gender: M<br />gender: M<br />gender: M"],"type":"scatter","mode":"lines","line":{"width":0,"color":"rgba(41,128,185,0.5)","dash":"solid"},"fill":"toself","fillcolor":"rgba(0,191,196,0.5)","hoveron":"points","name":"(M,3)","legendgroup":"(M,3)","showlegend":true,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[1,2,3,4,4,4,3,2,1,1],"y":[7.6307388341178051,5.6602833685091083,5.957267033323479,6.1328340559156009,6.1328340559156009,15.544909293772228,19.424192187140822,19.038225520543911,21.66653650976415,7.6307388341178051],"text":["year: 2005<br />mean: 13.431700<br />percentile_97.5: 21.66654<br />percentile_2.5:  7.63073883<br />gender: M<br />gender: M<br />gender: M","year: 2010<br />mean: 11.814473<br />percentile_97.5: 19.03823<br />percentile_2.5:  5.66028337<br />gender: M<br />gender: M<br />gender: M","year: 2015<br />mean: 10.457162<br />percentile_97.5: 19.42419<br />percentile_2.5:  5.95726703<br />gender: M<br />gender: M<br />gender: M","year: 2020<br />mean: 10.148828<br />percentile_97.5: 15.54491<br />percentile_2.5:  6.13283406<br />gender: M<br />gender: M<br />gender: M","year: 2020<br />mean: 10.148828<br />percentile_97.5: 15.54491<br />percentile_2.5:  6.13283406<br />gender: M<br />gender: M<br />gender: M","year: 2020<br />mean: 10.148828<br />percentile_97.5: 15.54491<br />percentile_2.5:  6.13283406<br />gender: M<br />gender: M<br />gender: M","year: 2015<br />mean: 10.457162<br />percentile_97.5: 19.42419<br />percentile_2.5:  5.95726703<br />gender: M<br />gender: M<br />gender: M","year: 2010<br />mean: 11.814473<br />percentile_97.5: 19.03823<br />percentile_2.5:  5.66028337<br />gender: M<br />gender: M<br />gender: M","year: 2005<br />mean: 13.431700<br />percentile_97.5: 21.66654<br />percentile_2.5:  7.63073883<br />gender: M<br />gender: M<br />gender: M","year: 2005<br />mean: 13.431700<br />percentile_97.5: 21.66654<br />percentile_2.5:  7.63073883<br />gender: M<br />gender: M<br />gender: M"],"type":"scatter","mode":"lines","line":{"width":0,"color":"rgba(41,128,185,0.5)","dash":"solid"},"fill":"toself","fillcolor":"rgba(0,191,196,0.5)","hoveron":"points","name":"(M,4)","legendgroup":"(M,4)","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[1,2,3,4],"y":[5.3273934495184019,8.1034922134170149,11.726414848576409,14.544723146618084],"text":["year: 2005<br />mean:  5.327393<br />percentile_97.5: 13.72188<br />percentile_2.5:  0.15944385<br />gender: F<br />gender: F<br />gender: F<br />linetype: ","year: 2010<br />mean:  8.103492<br />percentile_97.5: 22.44338<br />percentile_2.5:  3.03878309<br />gender: F<br />gender: F<br />gender: F<br />linetype: ","year: 2015<br />mean: 11.726415<br />percentile_97.5: 21.94356<br />percentile_2.5:  6.33892441<br />gender: F<br />gender: F<br />gender: F<br />linetype: ","year: 2020<br />mean: 14.544723<br />percentile_97.5: 30.69405<br />percentile_2.5:  8.38527948<br />gender: F<br />gender: F<br />gender: F<br />linetype: "],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(192,57,43,1)","dash":"solid"},"hoveron":"points","name":"(F,)","legendgroup":"(F,)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4],"y":[6.2951767433215311,6.3469177228192253,5.7651327617218211,6.1674881743824077],"text":["year: 2005<br />mean:  6.295177<br />percentile_97.5: 18.52093<br />percentile_2.5:  0.42472342<br />gender: F<br />gender: F<br />gender: F<br />linetype: ","year: 2010<br />mean:  6.346918<br />percentile_97.5: 19.44081<br />percentile_2.5:  0.35666507<br />gender: F<br />gender: F<br />gender: F<br />linetype: ","year: 2015<br />mean:  5.765133<br />percentile_97.5: 17.24832<br />percentile_2.5:  0.00000000<br />gender: F<br />gender: F<br />gender: F<br />linetype: ","year: 2020<br />mean:  6.167488<br />percentile_97.5: 18.13076<br />percentile_2.5:  0.11828105<br />gender: F<br />gender: F<br />gender: F<br />linetype: "],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(192,57,43,1)","dash":"solid"},"hoveron":"points","name":"(F,)","legendgroup":"(F,)","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4],"y":[6.0269653117263298,10.944575584138081,7.0092276216609655,12.845895439423304],"text":["year: 2005<br />mean:  6.026965<br />percentile_97.5: 14.77819<br />percentile_2.5:  0.05346676<br />gender: F<br />gender: F<br />gender: F<br />linetype: ","year: 2010<br />mean: 10.944576<br />percentile_97.5: 21.31982<br />percentile_2.5:  4.96576026<br />gender: F<br />gender: F<br />gender: F<br />linetype: ","year: 2015<br />mean:  7.009228<br />percentile_97.5: 15.30529<br />percentile_2.5:  0.22485585<br />gender: F<br />gender: F<br />gender: F<br />linetype: ","year: 2020<br />mean: 12.845895<br />percentile_97.5: 23.15982<br />percentile_2.5:  6.71119022<br />gender: F<br />gender: F<br />gender: F<br />linetype: "],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(192,57,43,1)","dash":"solid"},"hoveron":"points","name":"(F,)","legendgroup":"(F,)","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[1,2,3,4],"y":[7.711203428266999,6.5829653492869662,5.1087669583250221,4.2808186649191384],"text":["year: 2005<br />mean:  7.711203<br />percentile_97.5: 18.60670<br />percentile_2.5:  0.61719762<br />gender: F<br />gender: F<br />gender: F<br />linetype: ","year: 2010<br />mean:  6.582965<br />percentile_97.5: 16.75625<br />percentile_2.5:  0.01230114<br />gender: F<br />gender: F<br />gender: F<br />linetype: ","year: 2015<br />mean:  5.108767<br />percentile_97.5: 13.60658<br />percentile_2.5:  0.00000000<br />gender: F<br />gender: F<br />gender: F<br />linetype: ","year: 2020<br />mean:  4.280819<br />percentile_97.5: 16.42367<br />percentile_2.5:  0.00000000<br />gender: F<br />gender: F<br />gender: F<br />linetype: "],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(192,57,43,1)","dash":"solid"},"hoveron":"points","name":"(F,)","legendgroup":"(F,)","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[1,2,3,4],"y":[12.149497959716998,16.253586080226828,18.502822784263497,21.32984388588028],"text":["year: 2005<br />mean: 12.149498<br />percentile_97.5: 19.28668<br />percentile_2.5:  7.19004210<br />gender: M<br />gender: M<br />gender: M<br />linetype: ","year: 2010<br />mean: 16.253586<br />percentile_97.5: 24.66206<br />percentile_2.5:  9.16869479<br />gender: M<br />gender: M<br />gender: M<br />linetype: ","year: 2015<br />mean: 18.502823<br />percentile_97.5: 26.48760<br />percentile_2.5: 13.32513382<br />gender: M<br />gender: M<br />gender: M<br />linetype: ","year: 2020<br />mean: 21.329844<br />percentile_97.5: 30.33517<br />percentile_2.5: 14.04684578<br />gender: M<br />gender: M<br />gender: M<br />linetype: "],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(41,128,185,1)","dash":"solid"},"hoveron":"points","name":"(M,)","legendgroup":"(M,)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4],"y":[13.50146436733943,13.713106840324878,13.811595540248842,13.960147870405367],"text":["year: 2005<br />mean: 13.501464<br />percentile_97.5: 25.41128<br />percentile_2.5:  6.17995320<br />gender: M<br />gender: M<br />gender: M<br />linetype: ","year: 2010<br />mean: 13.713107<br />percentile_97.5: 22.43224<br />percentile_2.5:  6.83216155<br />gender: M<br />gender: M<br />gender: M<br />linetype: ","year: 2015<br />mean: 13.811596<br />percentile_97.5: 25.09787<br />percentile_2.5:  8.01411802<br />gender: M<br />gender: M<br />gender: M<br />linetype: ","year: 2020<br />mean: 13.960148<br />percentile_97.5: 25.86392<br />percentile_2.5:  7.95955422<br />gender: M<br />gender: M<br />gender: M<br />linetype: "],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(41,128,185,1)","dash":"solid"},"hoveron":"points","name":"(M,)","legendgroup":"(M,)","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4],"y":[13.125231487618519,17.705141044354569,14.341442430615494,19.539365277157756],"text":["year: 2005<br />mean: 13.125231<br />percentile_97.5: 22.55638<br />percentile_2.5:  7.61914825<br />gender: M<br />gender: M<br />gender: M<br />linetype: ","year: 2010<br />mean: 17.705141<br />percentile_97.5: 27.74972<br />percentile_2.5: 11.17731523<br />gender: M<br />gender: M<br />gender: M<br />linetype: ","year: 2015<br />mean: 14.341442<br />percentile_97.5: 25.21691<br />percentile_2.5:  7.09923931<br />gender: M<br />gender: M<br />gender: M<br />linetype: ","year: 2020<br />mean: 19.539365<br />percentile_97.5: 32.10270<br />percentile_2.5: 13.18569055<br />gender: M<br />gender: M<br />gender: M<br />linetype: "],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(41,128,185,1)","dash":"solid"},"hoveron":"points","name":"(M,)","legendgroup":"(M,)","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[1,2,3,4],"y":[13.431699684721654,11.814472805553699,10.457161962772529,10.148827669080109],"text":["year: 2005<br />mean: 13.431700<br />percentile_97.5: 21.66654<br />percentile_2.5:  7.63073883<br />gender: M<br />gender: M<br />gender: M<br />linetype: ","year: 2010<br />mean: 11.814473<br />percentile_97.5: 19.03823<br />percentile_2.5:  5.66028337<br />gender: M<br />gender: M<br />gender: M<br />linetype: ","year: 2015<br />mean: 10.457162<br />percentile_97.5: 19.42419<br />percentile_2.5:  5.95726703<br />gender: M<br />gender: M<br />gender: M<br />linetype: ","year: 2020<br />mean: 10.148828<br />percentile_97.5: 15.54491<br />percentile_2.5:  6.13283406<br />gender: M<br />gender: M<br />gender: M<br />linetype: "],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(41,128,185,1)","dash":"solid"},"hoveron":"points","name":"(M,)","legendgroup":"(M,)","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":52.529680365296812,"r":7.3059360730593621,"b":37.260273972602747,"l":37.260273972602747},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"The difference between men and women was consistent over time","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342468},"x":0,"xref":"paper"},"xaxis":{"domain":[0,0.48912807131985214],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,4.5999999999999996],"tickmode":"array","ticktext":["2005","2010","2015","2020"],"tickvals":[1,2,3,4],"categoryorder":"array","categoryarray":["2005","2010","2015","2020"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0,"zeroline":false,"anchor":"y2","title":"","hoverformat":".2f"},"annotations":[{"text":"year","x":0.5,"y":0,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"top","annotationType":"axis","yshift":-21.917808219178088},{"text":"Rate","x":0,"y":0.5,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xref":"paper","yref":"paper","textangle":-90,"xanchor":"right","yanchor":"center","annotationType":"axis","xshift":-21.917808219178088},{"text":"A","x":0.24456403565992607,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"B","x":0.75543596434007387,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"C","x":0.24456403565992607,"y":0.47173298543161557,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"D","x":0.75543596434007387,"y":0.47173298543161557,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"}],"yaxis":{"domain":[0.52826701456838443,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.6051349479493333,33.707833906935996],"tickmode":"array","ticktext":["0","10","20","30"],"tickvals":[0,10,20,30],"categoryorder":"array","categoryarray":["0","10","20","30"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":0.48912807131985214,"y0":0.52826701456838443,"y1":1},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":0.48912807131985214,"y0":0,"y1":23.37899543378996,"yanchor":1,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0.51087192868014786,"x1":1,"y0":0.52826701456838443,"y1":1},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","layer":"below","x0":0.51087192868014786,"x1":1,"y0":0,"y1":23.37899543378996,"yanchor":1,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":0.48912807131985214,"y0":0,"y1":0.47173298543161557},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":0.48912807131985214,"y0":0,"y1":23.37899543378996,"yanchor":0.47173298543161557,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0.51087192868014786,"x1":1,"y0":0,"y1":0.47173298543161557},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","layer":"below","x0":0.51087192868014786,"x1":1,"y0":0,"y1":23.37899543378996,"yanchor":0.47173298543161557,"ysizemode":"pixel"}],"xaxis2":{"type":"linear","autorange":false,"range":[0.40000000000000002,4.5999999999999996],"tickmode":"array","ticktext":["2005","2010","2015","2020"],"tickvals":[1,2,3,4],"categoryorder":"array","categoryarray":["2005","2010","2015","2020"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.51087192868014786,1],"gridcolor":"rgba(255,255,255,1)","gridwidth":0,"zeroline":false,"anchor":"y2","title":"","hoverformat":".2f"},"yaxis2":{"type":"linear","autorange":false,"range":[-1.6051349479493333,33.707833906935996],"tickmode":"array","ticktext":["0","10","20","30"],"tickvals":[0,10,20,30],"categoryorder":"array","categoryarray":["0","10","20","30"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0,0.47173298543161557],"gridcolor":"rgba(255,255,255,1)","gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Gender<br />Gender+Strata<br />Level Average","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative","width":8,"height":3.5},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"dca815a7b91":{"x":{},"y":{},"ymax":{},"ymin":{},"fill":{},"colour":{},"type":"scatter"},"dca85b666d48":{"x":{},"y":{},"ymax":{},"ymin":{},"fill":{},"colour":{},"linetype":{}}},"cur_data":"dca815a7b91","visdat":{"dca815a7b91":["function (y) ","x"],"dca85b666d48":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
]


```
## Warning: Specifying width/height in layout() is now deprecated.
## Please specify in ggplotly() or plot_ly()
```

<div class="plotly html-widget html-fill-item" id="htmlwidget-87b0d1e27c211d1cc410" style="width:100%;height:504px;"></div>
<script type="application/json" data-for="htmlwidget-87b0d1e27c211d1cc410">{"x":{"data":[{"x":[1,2,3,4,4,3,2,1,1],"y":[0.15944384779508064,3.0387830915421765,6.3389244118795549,8.385279481257653,30.694048988616057,21.94356444316869,22.443381232513801,13.721880058389864,0.15944384779508064],"text":["year: 2005<br />mean:  5.327393<br />percentile_97.5: 13.72188<br />percentile_2.5:  0.15944385<br />gender: F<br />gender: F<br />gender: F","year: 2010<br />mean:  8.103492<br />percentile_97.5: 22.44338<br />percentile_2.5:  3.03878309<br />gender: F<br />gender: F<br />gender: F","year: 2015<br />mean: 11.726415<br />percentile_97.5: 21.94356<br />percentile_2.5:  6.33892441<br />gender: F<br />gender: F<br />gender: F","year: 2020<br />mean: 14.544723<br />percentile_97.5: 30.69405<br />percentile_2.5:  8.38527948<br />gender: F<br />gender: F<br />gender: F","year: 2020<br />mean: 14.544723<br />percentile_97.5: 30.69405<br />percentile_2.5:  8.38527948<br />gender: F<br />gender: F<br />gender: F","year: 2015<br />mean: 11.726415<br />percentile_97.5: 21.94356<br />percentile_2.5:  6.33892441<br />gender: F<br />gender: F<br />gender: F","year: 2010<br />mean:  8.103492<br />percentile_97.5: 22.44338<br />percentile_2.5:  3.03878309<br />gender: F<br />gender: F<br />gender: F","year: 2005<br />mean:  5.327393<br />percentile_97.5: 13.72188<br />percentile_2.5:  0.15944385<br />gender: F<br />gender: F<br />gender: F","year: 2005<br />mean:  5.327393<br />percentile_97.5: 13.72188<br />percentile_2.5:  0.15944385<br />gender: F<br />gender: F<br />gender: F"],"type":"scatter","mode":"lines","line":{"width":0,"color":"rgba(192,57,43,0.5)","dash":"solid"},"fill":"toself","fillcolor":"rgba(248,118,109,0.5)","hoveron":"points","name":"(F,1)","legendgroup":"(F,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,4,3,2,1,1],"y":[0.42472341838013028,0.35666507405595671,0,0.11828104578049344,18.130757566877488,17.248324050288311,19.440812875920024,18.520926916008811,0.42472341838013028],"text":["year: 2005<br />mean:  6.295177<br />percentile_97.5: 18.52093<br />percentile_2.5:  0.42472342<br />gender: F<br />gender: F<br />gender: F","year: 2010<br />mean:  6.346918<br />percentile_97.5: 19.44081<br />percentile_2.5:  0.35666507<br />gender: F<br />gender: F<br />gender: F","year: 2015<br />mean:  5.765133<br />percentile_97.5: 17.24832<br />percentile_2.5:  0.00000000<br />gender: F<br />gender: F<br />gender: F","year: 2020<br />mean:  6.167488<br />percentile_97.5: 18.13076<br />percentile_2.5:  0.11828105<br />gender: F<br />gender: F<br />gender: F","year: 2020<br />mean:  6.167488<br />percentile_97.5: 18.13076<br />percentile_2.5:  0.11828105<br />gender: F<br />gender: F<br />gender: F","year: 2015<br />mean:  5.765133<br />percentile_97.5: 17.24832<br />percentile_2.5:  0.00000000<br />gender: F<br />gender: F<br />gender: F","year: 2010<br />mean:  6.346918<br />percentile_97.5: 19.44081<br />percentile_2.5:  0.35666507<br />gender: F<br />gender: F<br />gender: F","year: 2005<br />mean:  6.295177<br />percentile_97.5: 18.52093<br />percentile_2.5:  0.42472342<br />gender: F<br />gender: F<br />gender: F","year: 2005<br />mean:  6.295177<br />percentile_97.5: 18.52093<br />percentile_2.5:  0.42472342<br />gender: F<br />gender: F<br />gender: F"],"type":"scatter","mode":"lines","line":{"width":0,"color":"rgba(192,57,43,0.5)","dash":"solid"},"fill":"toself","fillcolor":"rgba(248,118,109,0.5)","hoveron":"points","name":"(F,2)","legendgroup":"(F,2)","showlegend":true,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,4,3,2,1,1],"y":[0.053466760163304351,4.965760261352167,0.22485584758449795,6.7111902190070687,23.15981707547493,15.305294172688725,21.319821512747897,14.778189881749258,0.053466760163304351],"text":["year: 2005<br />mean:  6.026965<br />percentile_97.5: 14.77819<br />percentile_2.5:  0.05346676<br />gender: F<br />gender: F<br />gender: F","year: 2010<br />mean: 10.944576<br />percentile_97.5: 21.31982<br />percentile_2.5:  4.96576026<br />gender: F<br />gender: F<br />gender: F","year: 2015<br />mean:  7.009228<br />percentile_97.5: 15.30529<br />percentile_2.5:  0.22485585<br />gender: F<br />gender: F<br />gender: F","year: 2020<br />mean: 12.845895<br />percentile_97.5: 23.15982<br />percentile_2.5:  6.71119022<br />gender: F<br />gender: F<br />gender: F","year: 2020<br />mean: 12.845895<br />percentile_97.5: 23.15982<br />percentile_2.5:  6.71119022<br />gender: F<br />gender: F<br />gender: F","year: 2015<br />mean:  7.009228<br />percentile_97.5: 15.30529<br />percentile_2.5:  0.22485585<br />gender: F<br />gender: F<br />gender: F","year: 2010<br />mean: 10.944576<br />percentile_97.5: 21.31982<br />percentile_2.5:  4.96576026<br />gender: F<br />gender: F<br />gender: F","year: 2005<br />mean:  6.026965<br />percentile_97.5: 14.77819<br />percentile_2.5:  0.05346676<br />gender: F<br />gender: F<br />gender: F","year: 2005<br />mean:  6.026965<br />percentile_97.5: 14.77819<br />percentile_2.5:  0.05346676<br />gender: F<br />gender: F<br />gender: F"],"type":"scatter","mode":"lines","line":{"width":0,"color":"rgba(192,57,43,0.5)","dash":"solid"},"fill":"toself","fillcolor":"rgba(248,118,109,0.5)","hoveron":"points","name":"(F,3)","legendgroup":"(F,3)","showlegend":true,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[1,2,3,4,4,3,2,1,1],"y":[0.61719762387025068,0.012301143588057699,0,0,16.423673254148444,13.606579742071446,16.756253402141212,18.606696163001747,0.61719762387025068],"text":["year: 2005<br />mean:  7.711203<br />percentile_97.5: 18.60670<br />percentile_2.5:  0.61719762<br />gender: F<br />gender: F<br />gender: F","year: 2010<br />mean:  6.582965<br />percentile_97.5: 16.75625<br />percentile_2.5:  0.01230114<br />gender: F<br />gender: F<br />gender: F","year: 2015<br />mean:  5.108767<br />percentile_97.5: 13.60658<br />percentile_2.5:  0.00000000<br />gender: F<br />gender: F<br />gender: F","year: 2020<br />mean:  4.280819<br />percentile_97.5: 16.42367<br />percentile_2.5:  0.00000000<br />gender: F<br />gender: F<br />gender: F","year: 2020<br />mean:  4.280819<br />percentile_97.5: 16.42367<br />percentile_2.5:  0.00000000<br />gender: F<br />gender: F<br />gender: F","year: 2015<br />mean:  5.108767<br />percentile_97.5: 13.60658<br />percentile_2.5:  0.00000000<br />gender: F<br />gender: F<br />gender: F","year: 2010<br />mean:  6.582965<br />percentile_97.5: 16.75625<br />percentile_2.5:  0.01230114<br />gender: F<br />gender: F<br />gender: F","year: 2005<br />mean:  7.711203<br />percentile_97.5: 18.60670<br />percentile_2.5:  0.61719762<br />gender: F<br />gender: F<br />gender: F","year: 2005<br />mean:  7.711203<br />percentile_97.5: 18.60670<br />percentile_2.5:  0.61719762<br />gender: F<br />gender: F<br />gender: F"],"type":"scatter","mode":"lines","line":{"width":0,"color":"rgba(192,57,43,0.5)","dash":"solid"},"fill":"toself","fillcolor":"rgba(248,118,109,0.5)","hoveron":"points","name":"(F,4)","legendgroup":"(F,4)","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[1,2,3,4,4,3,2,1,1],"y":[7.1900421015077214,9.1686947902909033,13.325133821664501,14.046845780249361,30.335173709265501,26.487603391200388,24.66205762258954,19.28667855263485,7.1900421015077214],"text":["year: 2005<br />mean: 12.149498<br />percentile_97.5: 19.28668<br />percentile_2.5:  7.19004210<br />gender: M<br />gender: M<br />gender: M","year: 2010<br />mean: 16.253586<br />percentile_97.5: 24.66206<br />percentile_2.5:  9.16869479<br />gender: M<br />gender: M<br />gender: M","year: 2015<br />mean: 18.502823<br />percentile_97.5: 26.48760<br />percentile_2.5: 13.32513382<br />gender: M<br />gender: M<br />gender: M","year: 2020<br />mean: 21.329844<br />percentile_97.5: 30.33517<br />percentile_2.5: 14.04684578<br />gender: M<br />gender: M<br />gender: M","year: 2020<br />mean: 21.329844<br />percentile_97.5: 30.33517<br />percentile_2.5: 14.04684578<br />gender: M<br />gender: M<br />gender: M","year: 2015<br />mean: 18.502823<br />percentile_97.5: 26.48760<br />percentile_2.5: 13.32513382<br />gender: M<br />gender: M<br />gender: M","year: 2010<br />mean: 16.253586<br />percentile_97.5: 24.66206<br />percentile_2.5:  9.16869479<br />gender: M<br />gender: M<br />gender: M","year: 2005<br />mean: 12.149498<br />percentile_97.5: 19.28668<br />percentile_2.5:  7.19004210<br />gender: M<br />gender: M<br />gender: M","year: 2005<br />mean: 12.149498<br />percentile_97.5: 19.28668<br />percentile_2.5:  7.19004210<br />gender: M<br />gender: M<br />gender: M"],"type":"scatter","mode":"lines","line":{"width":0,"color":"rgba(41,128,185,0.5)","dash":"solid"},"fill":"toself","fillcolor":"rgba(0,191,196,0.5)","hoveron":"points","name":"(M,1)","legendgroup":"(M,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,4,3,2,1,1],"y":[6.1799531984469427,6.8321615459700276,8.014118023374154,7.9595542155274046,25.863923800295716,25.097873054944248,22.432236000146009,25.411280373218901,6.1799531984469427],"text":["year: 2005<br />mean: 13.501464<br />percentile_97.5: 25.41128<br />percentile_2.5:  6.17995320<br />gender: M<br />gender: M<br />gender: M","year: 2010<br />mean: 13.713107<br />percentile_97.5: 22.43224<br />percentile_2.5:  6.83216155<br />gender: M<br />gender: M<br />gender: M","year: 2015<br />mean: 13.811596<br />percentile_97.5: 25.09787<br />percentile_2.5:  8.01411802<br />gender: M<br />gender: M<br />gender: M","year: 2020<br />mean: 13.960148<br />percentile_97.5: 25.86392<br />percentile_2.5:  7.95955422<br />gender: M<br />gender: M<br />gender: M","year: 2020<br />mean: 13.960148<br />percentile_97.5: 25.86392<br />percentile_2.5:  7.95955422<br />gender: M<br />gender: M<br />gender: M","year: 2015<br />mean: 13.811596<br />percentile_97.5: 25.09787<br />percentile_2.5:  8.01411802<br />gender: M<br />gender: M<br />gender: M","year: 2010<br />mean: 13.713107<br />percentile_97.5: 22.43224<br />percentile_2.5:  6.83216155<br />gender: M<br />gender: M<br />gender: M","year: 2005<br />mean: 13.501464<br />percentile_97.5: 25.41128<br />percentile_2.5:  6.17995320<br />gender: M<br />gender: M<br />gender: M","year: 2005<br />mean: 13.501464<br />percentile_97.5: 25.41128<br />percentile_2.5:  6.17995320<br />gender: M<br />gender: M<br />gender: M"],"type":"scatter","mode":"lines","line":{"width":0,"color":"rgba(41,128,185,0.5)","dash":"solid"},"fill":"toself","fillcolor":"rgba(0,191,196,0.5)","hoveron":"points","name":"(M,2)","legendgroup":"(M,2)","showlegend":true,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,4,3,2,1,1],"y":[7.6191482482537651,11.17731523081488,7.0992393115585273,13.185690546664805,32.102698958986664,25.216910959717616,27.749722965597254,22.556376479097064,7.6191482482537651],"text":["year: 2005<br />mean: 13.125231<br />percentile_97.5: 22.55638<br />percentile_2.5:  7.61914825<br />gender: M<br />gender: M<br />gender: M","year: 2010<br />mean: 17.705141<br />percentile_97.5: 27.74972<br />percentile_2.5: 11.17731523<br />gender: M<br />gender: M<br />gender: M","year: 2015<br />mean: 14.341442<br />percentile_97.5: 25.21691<br />percentile_2.5:  7.09923931<br />gender: M<br />gender: M<br />gender: M","year: 2020<br />mean: 19.539365<br />percentile_97.5: 32.10270<br />percentile_2.5: 13.18569055<br />gender: M<br />gender: M<br />gender: M","year: 2020<br />mean: 19.539365<br />percentile_97.5: 32.10270<br />percentile_2.5: 13.18569055<br />gender: M<br />gender: M<br />gender: M","year: 2015<br />mean: 14.341442<br />percentile_97.5: 25.21691<br />percentile_2.5:  7.09923931<br />gender: M<br />gender: M<br />gender: M","year: 2010<br />mean: 17.705141<br />percentile_97.5: 27.74972<br />percentile_2.5: 11.17731523<br />gender: M<br />gender: M<br />gender: M","year: 2005<br />mean: 13.125231<br />percentile_97.5: 22.55638<br />percentile_2.5:  7.61914825<br />gender: M<br />gender: M<br />gender: M","year: 2005<br />mean: 13.125231<br />percentile_97.5: 22.55638<br />percentile_2.5:  7.61914825<br />gender: M<br />gender: M<br />gender: M"],"type":"scatter","mode":"lines","line":{"width":0,"color":"rgba(41,128,185,0.5)","dash":"solid"},"fill":"toself","fillcolor":"rgba(0,191,196,0.5)","hoveron":"points","name":"(M,3)","legendgroup":"(M,3)","showlegend":true,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[1,2,3,4,4,4,3,2,1,1],"y":[7.6307388341178051,5.6602833685091083,5.957267033323479,6.1328340559156009,6.1328340559156009,15.544909293772228,19.424192187140822,19.038225520543911,21.66653650976415,7.6307388341178051],"text":["year: 2005<br />mean: 13.431700<br />percentile_97.5: 21.66654<br />percentile_2.5:  7.63073883<br />gender: M<br />gender: M<br />gender: M","year: 2010<br />mean: 11.814473<br />percentile_97.5: 19.03823<br />percentile_2.5:  5.66028337<br />gender: M<br />gender: M<br />gender: M","year: 2015<br />mean: 10.457162<br />percentile_97.5: 19.42419<br />percentile_2.5:  5.95726703<br />gender: M<br />gender: M<br />gender: M","year: 2020<br />mean: 10.148828<br />percentile_97.5: 15.54491<br />percentile_2.5:  6.13283406<br />gender: M<br />gender: M<br />gender: M","year: 2020<br />mean: 10.148828<br />percentile_97.5: 15.54491<br />percentile_2.5:  6.13283406<br />gender: M<br />gender: M<br />gender: M","year: 2020<br />mean: 10.148828<br />percentile_97.5: 15.54491<br />percentile_2.5:  6.13283406<br />gender: M<br />gender: M<br />gender: M","year: 2015<br />mean: 10.457162<br />percentile_97.5: 19.42419<br />percentile_2.5:  5.95726703<br />gender: M<br />gender: M<br />gender: M","year: 2010<br />mean: 11.814473<br />percentile_97.5: 19.03823<br />percentile_2.5:  5.66028337<br />gender: M<br />gender: M<br />gender: M","year: 2005<br />mean: 13.431700<br />percentile_97.5: 21.66654<br />percentile_2.5:  7.63073883<br />gender: M<br />gender: M<br />gender: M","year: 2005<br />mean: 13.431700<br />percentile_97.5: 21.66654<br />percentile_2.5:  7.63073883<br />gender: M<br />gender: M<br />gender: M"],"type":"scatter","mode":"lines","line":{"width":0,"color":"rgba(41,128,185,0.5)","dash":"solid"},"fill":"toself","fillcolor":"rgba(0,191,196,0.5)","hoveron":"points","name":"(M,4)","legendgroup":"(M,4)","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[1,2,3,4],"y":[5.3273934495184019,8.1034922134170149,11.726414848576409,14.544723146618084],"text":["year: 2005<br />mean:  5.327393<br />percentile_97.5: 13.72188<br />percentile_2.5:  0.15944385<br />gender: F<br />gender: F<br />gender: F<br />linetype: ","year: 2010<br />mean:  8.103492<br />percentile_97.5: 22.44338<br />percentile_2.5:  3.03878309<br />gender: F<br />gender: F<br />gender: F<br />linetype: ","year: 2015<br />mean: 11.726415<br />percentile_97.5: 21.94356<br />percentile_2.5:  6.33892441<br />gender: F<br />gender: F<br />gender: F<br />linetype: ","year: 2020<br />mean: 14.544723<br />percentile_97.5: 30.69405<br />percentile_2.5:  8.38527948<br />gender: F<br />gender: F<br />gender: F<br />linetype: "],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(192,57,43,1)","dash":"solid"},"hoveron":"points","name":"(F,)","legendgroup":"(F,)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4],"y":[6.2951767433215311,6.3469177228192253,5.7651327617218211,6.1674881743824077],"text":["year: 2005<br />mean:  6.295177<br />percentile_97.5: 18.52093<br />percentile_2.5:  0.42472342<br />gender: F<br />gender: F<br />gender: F<br />linetype: ","year: 2010<br />mean:  6.346918<br />percentile_97.5: 19.44081<br />percentile_2.5:  0.35666507<br />gender: F<br />gender: F<br />gender: F<br />linetype: ","year: 2015<br />mean:  5.765133<br />percentile_97.5: 17.24832<br />percentile_2.5:  0.00000000<br />gender: F<br />gender: F<br />gender: F<br />linetype: ","year: 2020<br />mean:  6.167488<br />percentile_97.5: 18.13076<br />percentile_2.5:  0.11828105<br />gender: F<br />gender: F<br />gender: F<br />linetype: "],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(192,57,43,1)","dash":"solid"},"hoveron":"points","name":"(F,)","legendgroup":"(F,)","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4],"y":[6.0269653117263298,10.944575584138081,7.0092276216609655,12.845895439423304],"text":["year: 2005<br />mean:  6.026965<br />percentile_97.5: 14.77819<br />percentile_2.5:  0.05346676<br />gender: F<br />gender: F<br />gender: F<br />linetype: ","year: 2010<br />mean: 10.944576<br />percentile_97.5: 21.31982<br />percentile_2.5:  4.96576026<br />gender: F<br />gender: F<br />gender: F<br />linetype: ","year: 2015<br />mean:  7.009228<br />percentile_97.5: 15.30529<br />percentile_2.5:  0.22485585<br />gender: F<br />gender: F<br />gender: F<br />linetype: ","year: 2020<br />mean: 12.845895<br />percentile_97.5: 23.15982<br />percentile_2.5:  6.71119022<br />gender: F<br />gender: F<br />gender: F<br />linetype: "],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(192,57,43,1)","dash":"solid"},"hoveron":"points","name":"(F,)","legendgroup":"(F,)","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[1,2,3,4],"y":[7.711203428266999,6.5829653492869662,5.1087669583250221,4.2808186649191384],"text":["year: 2005<br />mean:  7.711203<br />percentile_97.5: 18.60670<br />percentile_2.5:  0.61719762<br />gender: F<br />gender: F<br />gender: F<br />linetype: ","year: 2010<br />mean:  6.582965<br />percentile_97.5: 16.75625<br />percentile_2.5:  0.01230114<br />gender: F<br />gender: F<br />gender: F<br />linetype: ","year: 2015<br />mean:  5.108767<br />percentile_97.5: 13.60658<br />percentile_2.5:  0.00000000<br />gender: F<br />gender: F<br />gender: F<br />linetype: ","year: 2020<br />mean:  4.280819<br />percentile_97.5: 16.42367<br />percentile_2.5:  0.00000000<br />gender: F<br />gender: F<br />gender: F<br />linetype: "],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(192,57,43,1)","dash":"solid"},"hoveron":"points","name":"(F,)","legendgroup":"(F,)","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[1,2,3,4],"y":[12.149497959716998,16.253586080226828,18.502822784263497,21.32984388588028],"text":["year: 2005<br />mean: 12.149498<br />percentile_97.5: 19.28668<br />percentile_2.5:  7.19004210<br />gender: M<br />gender: M<br />gender: M<br />linetype: ","year: 2010<br />mean: 16.253586<br />percentile_97.5: 24.66206<br />percentile_2.5:  9.16869479<br />gender: M<br />gender: M<br />gender: M<br />linetype: ","year: 2015<br />mean: 18.502823<br />percentile_97.5: 26.48760<br />percentile_2.5: 13.32513382<br />gender: M<br />gender: M<br />gender: M<br />linetype: ","year: 2020<br />mean: 21.329844<br />percentile_97.5: 30.33517<br />percentile_2.5: 14.04684578<br />gender: M<br />gender: M<br />gender: M<br />linetype: "],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(41,128,185,1)","dash":"solid"},"hoveron":"points","name":"(M,)","legendgroup":"(M,)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4],"y":[13.50146436733943,13.713106840324878,13.811595540248842,13.960147870405367],"text":["year: 2005<br />mean: 13.501464<br />percentile_97.5: 25.41128<br />percentile_2.5:  6.17995320<br />gender: M<br />gender: M<br />gender: M<br />linetype: ","year: 2010<br />mean: 13.713107<br />percentile_97.5: 22.43224<br />percentile_2.5:  6.83216155<br />gender: M<br />gender: M<br />gender: M<br />linetype: ","year: 2015<br />mean: 13.811596<br />percentile_97.5: 25.09787<br />percentile_2.5:  8.01411802<br />gender: M<br />gender: M<br />gender: M<br />linetype: ","year: 2020<br />mean: 13.960148<br />percentile_97.5: 25.86392<br />percentile_2.5:  7.95955422<br />gender: M<br />gender: M<br />gender: M<br />linetype: "],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(41,128,185,1)","dash":"solid"},"hoveron":"points","name":"(M,)","legendgroup":"(M,)","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4],"y":[13.125231487618519,17.705141044354569,14.341442430615494,19.539365277157756],"text":["year: 2005<br />mean: 13.125231<br />percentile_97.5: 22.55638<br />percentile_2.5:  7.61914825<br />gender: M<br />gender: M<br />gender: M<br />linetype: ","year: 2010<br />mean: 17.705141<br />percentile_97.5: 27.74972<br />percentile_2.5: 11.17731523<br />gender: M<br />gender: M<br />gender: M<br />linetype: ","year: 2015<br />mean: 14.341442<br />percentile_97.5: 25.21691<br />percentile_2.5:  7.09923931<br />gender: M<br />gender: M<br />gender: M<br />linetype: ","year: 2020<br />mean: 19.539365<br />percentile_97.5: 32.10270<br />percentile_2.5: 13.18569055<br />gender: M<br />gender: M<br />gender: M<br />linetype: "],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(41,128,185,1)","dash":"solid"},"hoveron":"points","name":"(M,)","legendgroup":"(M,)","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[1,2,3,4],"y":[13.431699684721654,11.814472805553699,10.457161962772529,10.148827669080109],"text":["year: 2005<br />mean: 13.431700<br />percentile_97.5: 21.66654<br />percentile_2.5:  7.63073883<br />gender: M<br />gender: M<br />gender: M<br />linetype: ","year: 2010<br />mean: 11.814473<br />percentile_97.5: 19.03823<br />percentile_2.5:  5.66028337<br />gender: M<br />gender: M<br />gender: M<br />linetype: ","year: 2015<br />mean: 10.457162<br />percentile_97.5: 19.42419<br />percentile_2.5:  5.95726703<br />gender: M<br />gender: M<br />gender: M<br />linetype: ","year: 2020<br />mean: 10.148828<br />percentile_97.5: 15.54491<br />percentile_2.5:  6.13283406<br />gender: M<br />gender: M<br />gender: M<br />linetype: "],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(41,128,185,1)","dash":"solid"},"hoveron":"points","name":"(M,)","legendgroup":"(M,)","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":52.529680365296812,"r":7.3059360730593621,"b":37.260273972602747,"l":37.260273972602747},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"The difference between men and women was consistent over time","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342468},"x":0,"xref":"paper"},"xaxis":{"domain":[0,0.48912807131985214],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,4.5999999999999996],"tickmode":"array","ticktext":["2005","2010","2015","2020"],"tickvals":[1,2,3,4],"categoryorder":"array","categoryarray":["2005","2010","2015","2020"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0,"zeroline":false,"anchor":"y2","title":"","hoverformat":".2f"},"annotations":[{"text":"year","x":0.5,"y":0,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"top","annotationType":"axis","yshift":-21.917808219178088},{"text":"Rate","x":0,"y":0.5,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xref":"paper","yref":"paper","textangle":-90,"xanchor":"right","yanchor":"center","annotationType":"axis","xshift":-21.917808219178088},{"text":"A","x":0.24456403565992607,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"B","x":0.75543596434007387,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"C","x":0.24456403565992607,"y":0.47173298543161557,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"D","x":0.75543596434007387,"y":0.47173298543161557,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"}],"yaxis":{"domain":[0.52826701456838443,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.6051349479493333,33.707833906935996],"tickmode":"array","ticktext":["0","10","20","30"],"tickvals":[0,10,20,30],"categoryorder":"array","categoryarray":["0","10","20","30"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":0.48912807131985214,"y0":0.52826701456838443,"y1":1},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":0.48912807131985214,"y0":0,"y1":23.37899543378996,"yanchor":1,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0.51087192868014786,"x1":1,"y0":0.52826701456838443,"y1":1},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","layer":"below","x0":0.51087192868014786,"x1":1,"y0":0,"y1":23.37899543378996,"yanchor":1,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":0.48912807131985214,"y0":0,"y1":0.47173298543161557},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","layer":"below","x0":0,"x1":0.48912807131985214,"y0":0,"y1":23.37899543378996,"yanchor":0.47173298543161557,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","layer":"below","x0":0.51087192868014786,"x1":1,"y0":0,"y1":0.47173298543161557},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0,"linetype":"solid"},"yref":"paper","xref":"paper","layer":"below","x0":0.51087192868014786,"x1":1,"y0":0,"y1":23.37899543378996,"yanchor":0.47173298543161557,"ysizemode":"pixel"}],"xaxis2":{"type":"linear","autorange":false,"range":[0.40000000000000002,4.5999999999999996],"tickmode":"array","ticktext":["2005","2010","2015","2020"],"tickvals":[1,2,3,4],"categoryorder":"array","categoryarray":["2005","2010","2015","2020"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.51087192868014786,1],"gridcolor":"rgba(255,255,255,1)","gridwidth":0,"zeroline":false,"anchor":"y2","title":"","hoverformat":".2f"},"yaxis2":{"type":"linear","autorange":false,"range":[-1.6051349479493333,33.707833906935996],"tickmode":"array","ticktext":["0","10","20","30"],"tickvals":[0,10,20,30],"categoryorder":"array","categoryarray":["0","10","20","30"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0,0.47173298543161557],"gridcolor":"rgba(255,255,255,1)","gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Gender<br />Gender+Strata<br />Level Average","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative","width":8,"height":3.5},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"dca824c7fd2e":{"x":{},"y":{},"ymax":{},"ymin":{},"fill":{},"colour":{},"type":"scatter"},"dca845bee9df":{"x":{},"y":{},"ymax":{},"ymin":{},"fill":{},"colour":{},"linetype":{}}},"cur_data":"dca824c7fd2e","visdat":{"dca824c7fd2e":["function (y) ","x"],"dca845bee9df":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>


---
# Widening Data for Correlation Analysis

Before we can look at correlation across the years, we need 
to widen the dataframe (similar to how it was originally formatted).


``` r
df_wide &lt;- df |&gt;
  tidyr::pivot_wider(id_cols = c(id, strata, gender),
                     names_from = year,
                     values_from = rate)
knitr::kable(head(df_wide, 3))
```

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; id &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; strata &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; gender &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; 2005 &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; 2010 &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; 2015 &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; 2020 &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; A &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; M &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10.50958 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 15.79646 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14.91858 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 25.42652 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; A &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; M &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 19.41370 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 25.08218 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 25.20033 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 30.43139 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; A &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; M &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 12.47516 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 19.26219 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 19.93076 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 20.63809 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
# Correlation Plot

.tiny[

``` r
# install.packages(GGally)
library(GGally)
ggpairs(df_wide, aes(color = strata, alpha=0.25), columns = c('2005', '2010', '2015', '2020'), progress=F)
```
]

&lt;img src="longitudinal_eda_files/figure-html/unnamed-chunk-28-1.png" width="576" height="100%" style="display: block; margin: auto;" /&gt;

---
# Bivariate Pairs Plots


``` r
ggbivariate(df, outcome = 'gender', explanatory = 'strata') + 
  theme(legend.position = 'bottom') + 
  ggtitle("Strata were about evenly split across gender")
```

&lt;img src="longitudinal_eda_files/figure-html/unnamed-chunk-29-1.png" width="432" height="100%" style="display: block; margin: auto;" /&gt;

---
&lt;img src="images/tt_logo.png" align='right' width='30%'
  style='padding: 0px;'&gt;

# Where you can learn more 

  
For data manipulation and visualization:

&lt;img src="images/ggplot2-cheatsheet.png" align='right' width='30%'
  style='padding: 0px;'&gt;
  
- R for Data Science, by Garrett Grolemund and Hadley Wickham, [r4ds.had.co.nz](https://r4ds.had.co.nz)
- The ggplot2 Website, [ggplot2.tidyverse.org](https://ggplot2.tidyverse.org)
- The [RStudio Cheatsheets](https://rstudio.com/resources/cheatsheets/) (I suggest starting with [dplyr](https://github.com/rstudio/cheatsheets/raw/master/data-transformation.pdf) and [ggplot2](https://github.com/rstudio/cheatsheets/raw/master/data-visualization-2.1.pdf))
- Watch the [TidyTuesday tutorials on YouTube](https://www.youtube.com/results?search_query=tidytuesday) or check out [TidyTuesday 
  on GitHub](https://github.com/rfordatascience/tidytuesday/)
  
  
  
--
For longitudinal data analysis: 
- [Applied Longitudinal Analysis by Garrett Fitzmaurice, Nan Laird, and James Ware](https://content.sph.harvard.edu/fitzmaur/ala2e/)
- [Marie Davidian's Slides on Modeling and Analysis of Longitudinal Data](https://www4.stat.ncsu.edu/~davidian/enar06_handout.pdf)
- [Patrick Hagearty's notes on Longitudinal Data Analysis](https://faculty.washington.edu/heagerty/Courses/VA-longitudinal/private/LDAchapter.pdf) (fairly technical)
- Longitudinal Data Analysis: Autoregressive Linear Mixed Effects Models, by Ikuko FunatogawaTakashi Funatogawa (very technical)

---
# How to take your longitudinal analysis further

.pull-left[
&lt;!-- &lt;div style='font-size: 75% !important;'&gt; --&gt;
&lt;ul&gt;
Use models to make inferences about your data. Models for longitudinal data
often include the following features: &lt;br&gt; &lt;br&gt;
&lt;li&gt; Multi-level or random effects design&lt;/li&gt;
&lt;li&gt; Generalized Linear Models&lt;/li&gt;
&lt;li&gt; Auto-regressive&lt;/li&gt;
&lt;li&gt; Treatment of missing data&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- &lt;/div&gt; --&gt;
]

.pull-right[
&lt;img src='images/multilevel-reaction.png'/&gt;

&lt;span style='font-size: 16px;'&gt;
`library(lme4)` &lt;br&gt;
`lmer(Reaction ~ Days + (Days|Subject), sleepstudy)`
&lt;/span&gt;
]

---

&lt;img src="images/tikz_statistic_vs_parameter/tikz_statistic_vs_parameter2.jpg" align='right' width='35%' style='padding: 10px;'&gt;&lt;br&gt;

# How to take your longitudinal analysis further (part 2)

Define your scientific question (`\(\to\)` statistical parameter) of interest first! 

Are you interested in a marginal mean? 
`$$\mathbb E[Y \mid T = t]$$`

Are you interested in subject-specific rates of increase?
$$ \frac{d}{dt} \mathbb E[ Y \mid T = t, \; \mathtt{id} = i] $$

* Is your hypothesis that heterogeneity in individual slopes exists? 
  * Or that you could predict them from certain baseline covariates? 
* Is your hypothesis about a covariate predicting worsening/improving
trends? 

---
# Get More Inspiration 

.pull-left[
* [Georgios Karamanis](https://karaman.is/)
* [Cedric Scherer](https://cedricscherer.com)
* [Eleanor Lutz](https://eleanorlutz.com/)
* [Flowing Data](https://flowingdata.com/)
&lt;img src="images/Kaashoek.png" alt="A figure showing effectiveness of statewide interventions as an effect modifier" /&gt;
&lt;span style='font-size: 12px;'&gt;Kaashoek J, Testa C, Chen JT, Stolerman LM, Krieger N, Hanage WP, et al. [The evolving roles of US political partisanship and social vulnerability in the COVID-19 pandemic from February 2020–February 2021.](https://journals.plos.org/globalpublichealth/article?id=10.1371/journal.pgph.0000557) PLOS Global Public Health. 2022 
&lt;/span&gt;
]

.pull-right[
&lt;img src="images/EscalatingDrought.jpg" height='500px' alt='A figure on drought from Cedric Scherer' /&gt;
]

---
# Join the R User Group! &amp;nbsp; rug-at-hdsi.org

.pull-left[
&lt;img src="images/rug.png" alt='screenshot of our RUG YouTube'&gt;&lt;br&gt;
Join at &lt;https://rug-at-hdsi.org&gt; and check out our [YouTube](https://www.youtube.com/@rusergroupatharvarddatasci7232/videos)
]
&lt;!-- .pull-right[
&lt;img src="images/tidymodels.png" style='max-height: 450px;' alt="poster for our upcoming talk on Tidymodels" /&gt;
] --&gt;


---
# Find this talk on my github


&lt;img src='screenshot.png' height='450px' /&gt;
&lt;img src='images/github_qr.png' style = 'vertical-align: top;' height='175px' /&gt;
&lt;https://github.com/ctesta01/longitudinal_eda_talk&gt;

---
# Image Credits

&lt;div style='font-size:small'&gt;

&lt;ul&gt;
&lt;li&gt;R for Data Science: https://www.dataoptimal.com/wp-content/uploads/R-for-Data-Science.jpg &lt;/li&gt;
&lt;li&gt;Magrittr Logo: https://magrittr.tidyverse.org/logo.png&lt;/li&gt;
&lt;li&gt;Tidy Tuesday Logo: https://github.com/rfordatascience/tidytuesday/&lt;/li&gt;
&lt;li&gt;Escalating Drought: https://www.scientificamerican.com/article/climate-change-drives-escalating-drought/&lt;/li&gt;
&lt;/ul&gt;
  
&lt;/div&gt;
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
  "highlightStyle": "github",
  "highlightLines": true
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
